<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>财务数据</title>
    <link rel="stylesheet" type="text/css" href="static/build/lib/easyui/easyui.css">
    <link href="static/build/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="static/build/lib/easyui/icon.css">
    <link rel="stylesheet" type="text/css" href="static/build/lib/easyui/demo.css">
    <link rel="stylesheet" href="static/css/style.css">



    <style>
        .finance{
            width: 100%;
            overflow: hidden;
            margin: 30px 0;
            background: #fff;
            padding-top: 30px;
            padding-left: 15px;
            box-sizing: border-box;

        }
        .financial-char {
            width: 1300px;
            height: 400px;
            position: absolute;
            left: 0;
            top: 0;
        }
        .finance-left{
            width: 100px;
            height: 400px;
            background: #fff;
            float: left;
        }
        .finance-left>button{
            margin-top: 20px;
        }

    </style>

</head>
<body>

<nav class="navbar navbar-default">
    <div class="login-info clearfix">
        <div class="container">
            <span class="pull-left get-date"> </span>
            <div class="pull-right">
                <span class="pull-right navbar-collapse">帮助中心</span>
                <div class="pull-right">
                    <a href="login.html">用户名</a>
                    <span>|</span>
                    <a href="login.html">退出</a>
                </div>

            </div>
        </div>
    </div>
    <div class="container">
        <div class="navbar-header">
            <button  type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                     data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="navbar-header logo">
                <a href="#" class="pull-left"></a>
                <span class="pull-left">金融街在线监控平台</span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav pull-right">
                <li><a href="index.html">主页 <span class="sr-only">(current)</span></a></li>
                <li><a href="base_data.html">基础数据</a></li>
                <li class="active"><a href="finance_data.html">财务数据</a></li>
                <li><a href="contract_data.html">合同数据</a></li>
                <li><a href="financing.html">融资数据</a></li>
                <li><a href="account_data.html">账户数据</a></li>
                <li><a href="loan_structure.html">贷款结构</a></li>
                <li><a href="capital_loss_count.html">资产损失准备计提</a></li>
                <li><a href="loss_management.html" style="padding-right: 0;">报损业务管理</a></li>

            </ul>

        </div>
    </div>
</nav>

<div class="container">
    <div class="finance ">
        <div class="finance-left">
            <button class="btn btn-primary">资产负债表</button>
            <button class="btn btn-primary">月度利润表</button>
            <button class="btn btn-primary">年度利润表</button>
            <button class="btn btn-primary">现金流量表</button>
        </div>
        <div class="btn-group btn-group-xs pull-right">
            <button type="button" class="btn btn-default">打印</button>
            <a type="button" class="btn btn-default">添加</a>

        </div>
     <!--   <a href="javascript:;" class="pull-right" style="position: relative;top: -10px;z-index: 2">添加</a>-->
        <div class=" " style="width: 1055px;height: 400px;border: 1px solid #ddd;position: relative;overflow: hidden;">

            <div class="financial-char" id="financial-char"></div>
        </div>

        <table class="easyui-datagrid  " id="tableView"  style="width:1170px;height:450px"
               data-options=" url: 'static/json/fuzhai.json', singleSelect: true, method: 'get', ">
            <thead data-options="frozen:true">
            <tr>
                <th data-options="field:'item',width:80"></th>
            </tr>
            </thead>
            <thead>
            <tr>
                <th data-options="field:'month1',width:100,align:'center'">2015-01-01</th>
                <th data-options="field:'month2',width:100,align:'center'">2015-01-02</th>
                <th data-options="field:'month3',width:100,align:'center'">2015-01-03</th>
                <th data-options="field:'month4',width:100,align:'center'">2015-01-04</th>
                <th data-options="field:'month5',width:100,align:'center'">2015-01-05</th>
                <th data-options="field:'month6',width:100,align:'center'">2015-01-06</th>
                <th data-options="field:'month7',width:100,align:'center'">2015-01-07</th>
                <th data-options="field:'month8',width:100,align:'center'">2015-01-08</th>
                <th data-options="field:'month9',width:100,align:'center'">2015-01-09</th>
                <th data-options="field:'month10',width:100,align:'center'">2015-01-10</th>
                <th data-options="field:'month11',width:100,align:'center'">2015-01-11</th>
                <th data-options="field:'month12',width:100,align:'center'">2015-01-12</th>
            </tr>
            </thead>
        </table>
    </div>

</div>







<script src="static/build/lib/jquery.min.js"></script>
<script src="static/build/lib/sea.min.js"></script>
<script src="static/build/js/base.min.js"></script>
<script type="text/javascript" src="static/build/lib/easyui/jquery.easyui.min.js"></script>
<script src="static/build/lib/echarts/echarts.js"></script>
<script>
    $(function () {



        var $echarView = $('#financial-char'),       // char
            $tableView = $('#tableView'),            //table 视图
            $tabBtn = $('.finance-left>button'),        // 却换按钮

            titleArr =[
                '2015-01-01',
                '2015-01-02',
                '2015-01-03',
                '2015-01-04',
                '2015-01-05',
                '2015-01-06',
                '2015-01-07',
                '2015-01-08',
                '2015-01-09',
                '2015-01-10',
                '2015-01-11',
                '2015-01-12',
            ],     //标题数组
            contentArr = [],     // 存放一行内容数组
            titleName = '',      //char 的标题

            url = "static/json/fuzhai.json",
            urlArr = [
                "static/json/fuzhai.json",
                "static/json/niandu.json",
                "static/json/xianjin.json",
                "static/json/yuedu.json"
            ]



        $tabBtn.on('click',function () {
            var index = $(this).index();
            url = urlArr[index];
            render(0);
        })

        // 初次加载 生成第一行数据的绘制char
        render(0);
        // 根据行号绘制char
        function render(rowIndex) {
            $.ajax({
                url: url,
                dataType: 'json',
                success: function (data) {
                    // 重定向url 更新tableView
                    $tableView.datagrid({url:url});

                    //重新绘制char
                    contentArr = []; // 清空数组
                    for (var i in data[rowIndex]) {
                        contentArr.push(data[rowIndex][i]);
                    }
                    titleName = contentArr.slice(1,2).toString();
                    contentArr.splice(0,2);

                    //横向滚动条联动
                    var contents2 = $('div.datagrid-view2 div.datagrid-body');
                    contents2.on('mousedown', function () {
                        contents2.on('scroll', function (event) {
                            var e = event || window.event;
                            var leftX = -e.currentTarget.scrollLeft;
                            $echarView.css('left', leftX);
                        });
                    });
                    renderchar();
                }
            })
        }

        function renderchar() {
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('financial-char'));
            // 指定图表的配置项和数据
            var option = {
                title : {
                    subtext: '单位万元',
                },
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    data: [titleName]
                },
                textStyle: {
                    color: 'black'
                },
                backgroundColor: "white",
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    offset: 10,
                    data: titleArr
                },
                yAxis: {
                    type: 'value',
                    show: true,
                    offset: 10,
                    axisLabel: {
//                        formatter: '{value}万元'
                    },
                },
                series: [
                    {
                        name: titleName,
                        type: 'line',
                        data: contentArr,
                        markPoint: {
                            data: [
                                {type: 'max', name: '最大值'},
                                {type: 'min', name: '最小值'},
                            ]
                        },
                        itemStyle : { normal: {label : {show: true}}}
                    },
                ]
            };
            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);
        };

        // 定义点击行的回调函数
        $tableView.datagrid({
            onClickRow: function (rowIndex) {
                render(rowIndex);
            }
        })




    })
</script>

</body>
</html>